<div header >
	<nav id=header__ID class="navbar navbar-default navbar-fixed-top">
	  <div class="container-fluid">
	    <div class="navbar-header">
	      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	      </button>
		  <div class='hidden-xs hidden-sm'>
	      	<a class="navbar-brand" onclick="vm_nav_click_process('home');" style='cursor:pointer'><img src="images/childfund_logo.png" style="height:60px"></a>
		  </div>
		  <div class='hidden-md hidden-lg'>
	      	<a class="navbar-brand" onclick="vm_nav_click_process('home');"  style='cursor:pointer'><img src="images/childfund_logo.png"  style="height:30px"></a>
		  </div>
	    </div>
	    <div class="collapse navbar-collapse" id="myNavbar" style='padding-right:50px'>
	      <ul class="nav navbar-nav navbar-right">
	        <li><a class="glyphicon glyphicon-home" onclick="vm_nav_click_process('home');" style='cursor:pointer' >HOME</a></li>
			<li class="dropdown">
	          <a class="dropdown-toggle glyphicon glyphicon-pencil" data-toggle="dropdown" href="#">DATA ENTRY
	          <span class="caret"></span></a>
	          <ul class="dropdown-menu">
	            <li><a onclick="vm_nav_click_process('program_list');" style='cursor:pointer'>Program List</a></li>
	            <li><a onclick="vm_nav_click_process('quarterly_projection');" style='cursor:pointer'>Quarterly Projection</a></li>
	          </ul>
	        </li>
			<li class="dropdown">
	          <a class="dropdown-toggle glyphicon glyphicon-file" data-toggle="dropdown" href="#">DATA VIEW
	          <span class="caret"></span></a>
	          <ul class="dropdown-menu">
	            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Project Budget History</a></li>
	            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Project Documents</a></li>
	            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Project Acquittal Reports</a></li>
	          </ul>
	        </li>
			<li class="dropdown">
	          <a class="dropdown-toggle glyphicon glyphicon-list-alt" data-toggle="dropdown" href="#">REPORTING
	          <span class="caret"></span></a>
	          <ul class="dropdown-menu">
	            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Project Budget History</a></li>
	            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Project quarterly budget and actual</a></li>
	            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Project budget and actual by source</a></li>
				<li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Country project summary</a></li>
				<li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Country budget summary</a></li>
				<li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Country actual summary</a></li>
				<li class="dropdown-submenu">
		          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Finance reports
		          </a>
		          <ul class="dropdown-menu">
		            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Country budget and actual by source</a></li>
		            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Summary of confirmed funds</a></li>
		          </ul>
		        </li>
				<li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Projects with pending funds</a></li>
	          </ul>
	        </li>
			<li class="dropdown">
	          <a class="dropdown-toggle glyphicon glyphicon-book" data-toggle="dropdown" href="#">MANUALS
	          <span class="caret"></span></a>
	          <ul class="dropdown-menu">
	            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Program Handbook</a></li>
	            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>User Manual</a></li>
	          </ul>
	        </li>
			<li class="dropdown">
	          <a class="dropdown-toggle glyphicon glyphicon-download-alt" data-toggle="dropdown" href="#">EXPORT
	          <span class="caret"></span></a>
	          <ul class="dropdown-menu">
	            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Data</a></li>
	            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Files</a></li>
	          </ul>
	        </li>
			<li class="dropdown">
	          <a class="dropdown-toggle glyphicon glyphicon-wrench" data-toggle="dropdown" href="#">SETUP
	          <span class="caret"></span></a>
	          <ul class="dropdown-menu">
				  <li class="dropdown-submenu">
  		          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Email Alerts
  		          </a>
  		          <ul class="dropdown-menu">
  		            <li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>New Program</a></li>
					<li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>New Project</a></li>
					<li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>New Budget</a></li>
					<li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Project Status Change</a></li>
					<li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Request Fund</a></li>
  		          </ul>
  		        </li>
            	<li><a onclick="vm_nav_click_process('site');" style='cursor:pointer'>Site List</a></li>
				<li><a onclick="vm_nav_click_process('document_type');" style='cursor:pointer'>Document Type</a></li>
				<li><a onclick="vm_nav_click_process('region');" style='cursor:pointer'>Region List</a></li>
				<li><a onclick="vm_nav_click_process('country');" style='cursor:pointer'>Country Lis</a></li>
				<li><a onclick="vm_nav_click_process('sector');" style='cursor:pointer'>Sector List</a></li>
				<li><a onclick="vm_nav_click_process('location');" style='cursor:pointer'>Location List</a></li>
				<li><a onclick="vm_nav_click_process('funding_source');" style='cursor:pointer'>Funding Source List</a></li>
				<li><a onclick="vm_nav_click_process('theme');" style='cursor:pointer'>Theme List</a></li>
				<li><a onclick="vm_nav_click_process('implementation_arrangement');" style='cursor:pointer'>Implementation Arrangement List</a></li>
				<li><a onclick="vm_nav_click_process('drr_mainstreaming');" style='cursor:pointer'>DRR Mainstreaming List</a></li>
				<li><a onclick="vm_nav_click_process('approval_status');" style='cursor:pointer'>Project Approval Status</a></li>
				<li><a onclick="vm_nav_click_process('program_list_sub_table');" style='cursor:pointer'>Program List Sub Table</a></li>
				<li><a onclick="vm_nav_click_process('dev');" style='cursor:pointer'>Actual Spending - Spreadsheet</a></li>
	          </ul>
	        </li>
			<li><a name=signinout onclick="vm_nav_click_process('signinout')" style='cursor:pointer'></a></li>
	      </ul>
	    </div>
	  </div>
	</nav>
	<script navigation-processing>
		//-----------------------------------------
		var vm_nav_click_process=function(name){
			if( $(window).width()<786) $('.navbar-toggle').click();
			switch(name){
				case 'signinout':
					if($vm.user=='guest'){
						window.open($VmAPI.api_base+"signin.html?url="+window.location.href,"Sign In","width=600, height=600");
					}
					else{
						$VmAPI.clear_token();
						$VmAPI.request({data:{cmd:'signout'},callback:function(c){
							$vm.user="guest";
							$vm.user_id="";
							location.reload(true);
						}});
					}
					break;
				default:
					if(name=='dev'){
						$vm.alert('Under development');
					}
					else load_module(name);
					break;
			}
		}
		//-----------------------------------------
		var check_trust=function(url){
			var trust=0;
			if(url.indexOf('http://127.0.0.1')!=-1 || url.indexOf('http://localhost')!=-1){
				trust=1;
			}
			else{
				for(var i=0;i<$vm.trust_path.length;i++){
					var len=$vm.trust_path[i].length;
					if(url.indexOf($vm.trust_path[i])!==-1 && url.substring(0,len)==$vm.trust_path[i]){
						trust=1;
					}
				}
			}
			if(trust==0){
				alert("The url ("+url+") is not trusted.")
			}
			return trust;
		}
		//-----------------------------------------
		var load_module=function(name){
			if($vm.app_config.modules[name]!=undefined && $vm.app_config.modules[name].url!=undefined){
				if($vm.module_list[name]==undefined){
					$vm.module_list[name]=$vm.app_config.modules[name];
				}
			}
			var url=$vm.module_list[name].url;
			if(url.split('.').pop().split('?')[0]=='json'){
				load_panel(name)
				return;
			}
			if(url[0]=='/'){
				if($vm.hosting_path!=undefined) url=$vm.hosting_path+url;
			}
			var single_record=$vm.module_list[name].single_record;
			if(check_trust(url)==0) return;
			var op={
				//-----------------
				sys:{
					config:$vm.app_config,
					UID:name,
				},
				//-----------------
			}
			var slot=$vm.root_layout_content_slot;
			if(single_record=='1') slot=undefined;
			$vm.load_module_by_name(name,slot,op)
		};
		//---------------------------------------------
		var load_panel=function(name){
			var url=$vm.module_list[name].url;
			if(url[0]=='/'){
				if($vm.hosting_path!=undefined) url=$vm.hosting_path+url;
			}
			if(check_trust(url)==0) return;
			console.log('loading '+url);
			$.get(url,function(text){
				var text=$('<div/>').html(text).text();
				//---------------------------
				var config;
				try{ config=JSON.parse(text); }
				catch (e){ alert("Error in config file\n"+e); return; }
				//-----------------------------------------------
				var module=name+"_panel";
				if($vm.module_list[module]==undefined){
					$vm.module_list[module]={
						url:config.url,
						var:{},
					}
				}
				$vm.load_module_by_name(module,$vm.root_layout_content_slot,{
					sys:{
						config:config,
						UID:name,
					}
				})
				//-----------------------------------------------
			},'text').fail(function() {
				alert( "The file '"+url+"' doesn't exist!" );
			});
		}
		//---------------------------------------------
		var show_sign=function(){
			if($vm.user=='guest'){
				$('a[name=signinout]').html('<i class="fa fa-user"></i> SIGN IN')
				$('#username__ID').text('');
			}
			else{
				$('a[name=signinout]').html('<i class="fa fa-user"></i> SIGN OUT')
				$('#username__ID').text('Signed in as '+ $vm.user);
			}
		}
		show_sign();
		//-----------------------------------------

	</script>
	<style>
		#myNavbar{
			padding-top:30px;
		}
		@media screen and (max-width:768px){
			#myNavbar{
				padding-top:0px;
			}
		}
		.navbar {
	        font-family: Montserrat, sans-serif;
	        margin-bottom: 0;
	        background-color: #7EBA00;
	        border: 0;
	        font-size: 11px !important;
	        letter-spacing: 4px;
	        opacity: 0.9;
	    }
	    .navbar li a, .navbar .navbar-brand {
	        color: #d5d5d5 !important;
	    }
	    .navbar-nav li a:hover {
	        color: #fff !important;
	    }
	    .navbar-nav li.active a {
	        color: #fff !important;
	        background-color: #29292c !important;
	    }
	    .navbar-default .navbar-toggle {
	        border-color: transparent;
	    }
	    .open .dropdown-toggle {
	        color: #fff;
	        background-color: #555 !important;
	    }
	    .dropdown-menu li a {
	        color: #000 !important;
	    }
	    .dropdown-menu li a:hover {
	        background-color: red !important;
	    }
		.dropdown-submenu {
		    position:relative;
		}
		.dropdown-submenu>.dropdown-menu {
		    top:0;
		    right: 100%;
		    margin-top:-6px;
		    margin-left:-1px;
		    -webkit-border-radius:0 6px 6px 6px;
		    -moz-border-radius:0 6px 6px 6px;
		    border-radius:0 6px 6px 6px;
		}
		.dropdown-submenu:hover>.dropdown-menu {
		    display:block;
		}
		.dropdown-submenu>a:after {
		    display:block;
		    content:" ";
		    float:right;
		    width:0;
		    height:0;
		    border-color:transparent;
		    border-style:solid;
		    border-width:5px 0 5px 5px;
		    border-left-color:#cccccc;
		    margin-top:5px;
		    margin-right:-10px;
		}
		.dropdown-submenu:hover>a:after {
		    border-left-color:#ffffff;
		}
		.dropdown-submenu.pull-left {
		    float:none;
		}
		.dropdown-submenu.pull-left>.dropdown-menu {
		    right:-100%;
		    margin-right:10px;
		    -webkit-border-radius:6px 0 6px 6px;
		    -moz-border-radius:6px 0 6px 6px;
		    border-radius:6px 0 6px 6px;
		}	</style>
</div>
